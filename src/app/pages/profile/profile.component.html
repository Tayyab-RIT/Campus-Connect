<div *ngIf="isLoading" class="flex justify-center items-center h-screen">
    <div class="loader border-t-4 border-orange-500 w-16 h-16 rounded-full animate-spin"></div>
</div>

<div *ngIf="errorMessage" class="text-red-700 text-center text-lg font-bold mt-4">
    {{ errorMessage }}
</div>

<div *ngIf="!isLoading"
    class="max-w-5xl mx-auto p-8 bg-gradient-to-b from-gray-50 via-white to-gray-100 shadow-lg rounded-2xl">
    <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">Edit Profile</h2>

    <form (ngSubmit)="saveProfile()" #profileForm="ngForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Full Name -->
        <div>
            <label for="fullName" class="block text-sm font-semibold text-gray-700 mb-2">Full Name</label>
            <input type="text" id="fullName" [(ngModel)]="profileData.full_name" name="full_name" required
                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                placeholder="John Doe" />
        </div>

        <!-- Username -->
        <div>
            <label for="username" class="block text-sm font-semibold text-gray-700 mb-2">Unique Username</label>
            <input type="text" id="username" [(ngModel)]="profileData.username" name="username" required
                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                placeholder="johndoe123" />
            <a [routerLink]="['/profile', profileData.username]"
                class="text-orange-500 text-sm underline block mt-1">View Personal Profile ðŸ”— (save first)</a>
        </div>

        <!-- Profile Picture -->
        <div class="col-span-full">
            <label for="profilePicture" class="block text-sm font-semibold text-gray-700 mb-2">Profile Picture
                (URL)</label>
            <input type="text" id="profilePicture" [(ngModel)]="profileData.profile_picture" name="profile_picture"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                placeholder="https://example.com/photo.jpg" />
        </div>

        <!-- Degree Program -->
        <div>
            <label for="degreeProgram" class="block text-sm font-semibold text-gray-700 mb-2">Degree Program</label>
            <input type="text" id="degreeProgram" [(ngModel)]="profileData.degree_program" name="degree_program"
                required
                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                placeholder="Bachelor's in Computer Science" />
        </div>

        <!-- Year of Study -->
        <div>
            <label for="yearOfStudy" class="block text-sm font-semibold text-gray-700 mb-2">Year of Study</label>
            <input type="number" id="yearOfStudy" [(ngModel)]="profileData.year_of_study" name="year_of_study" required
                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                placeholder="3" />
        </div>

        <!-- GPA -->
        <div>
            <label for="gpa" class="block text-sm font-semibold text-gray-700 mb-2">GPA</label>
            <input type="number" id="gpa" [(ngModel)]="profileData.gpa" name="gpa" step="0.01" min="0" max="4"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                placeholder="3.8" />
        </div>

        <!-- Skills -->
        <div class="col-span-full">
            <label for="skills" class="block text-sm font-semibold text-gray-700 mb-2">Skills</label>
            <input type="text" id="skills" [(ngModel)]="profileData.skills" name="skills"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                placeholder="JavaScript, Python, Teamwork" />
        </div>

        <!-- Experience -->
        <div class="col-span-full">
            <label for="experience" class="block text-sm font-semibold text-gray-700 mb-2">Experience</label>
            <textarea id="experience" [(ngModel)]="profileData.experience" name="experience" rows="3"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                placeholder="Worked as an intern at XYZ company..."></textarea>
        </div>

        <!-- Certifications -->
        <div class="col-span-full">
            <label for="certifications" class="block text-sm font-semibold text-gray-700 mb-2">Certifications</label>
            <input type="text" id="certifications" [(ngModel)]="profileData.certifications" name="certifications"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                placeholder="Certified AWS Developer, Scrum Master" />
        </div>

        <!-- Social Media Links -->
        <div class="col-span-full grid grid-cols-2 gap-4">
            <div>
                <label for="linkedin" class="block text-sm font-semibold text-gray-700 mb-2">LinkedIn</label>
                <input type="url" id="linkedin" [(ngModel)]="profileData.linkedin_url" name="linkedin_url"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                    placeholder="https://linkedin.com/in/username" />
            </div>
            <div>
                <label for="github" class="block text-sm font-semibold text-gray-700 mb-2">GitHub</label>
                <input type="url" id="github" [(ngModel)]="profileData.github_url" name="github_url"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                    placeholder="https://github.com/username" />
            </div>
            <div>
                <label for="instagram" class="block text-sm font-semibold text-gray-700 mb-2">Instagram</label>
                <input type="url" id="instagram" [(ngModel)]="profileData.instagram_url" name="instagram_url"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                    placeholder="https://instagram.com/username" />
            </div>
            <div>
                <label for="twitter" class="block text-sm font-semibold text-gray-700 mb-2">Twitter</label>
                <input type="url" id="twitter" [(ngModel)]="profileData.twitter_url" name="twitter_url"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500"
                    placeholder="https://twitter.com/username" />
            </div>
        </div>

        <!-- Save Button -->
        <div class="col-span-full text-center mt-6">
            <button type="submit" [disabled]="isSaving"
                class="bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white px-8 py-3 rounded-lg shadow-md focus:ring-4 focus:ring-orange-400 focus:ring-offset-2 transition-all">
                Save Profile
            </button>
        </div>
    </form>
</div>